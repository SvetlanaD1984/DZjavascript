(()=>{"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class t{constructor(t,n){e(this,"_text",""),e(this,"_callback",null),this._text=t,this._callback=n}onBtnClick(){const e=this._callback;"function"==typeof e&&e()}getTemplate(){const e=document.createElement("button");return e.classList.add("btn"),e}render(e){if(e){const t=this.getTemplate();t.innerHTML=this._text,e.appendChild(t),t.addEventListener("click",(()=>{this.onBtnClick()}))}}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class i{constructor({name:e,price:t,img:i},s){n(this,"_name",""),n(this,"_price",0),n(this,"_img",0),n(this,"_CartInstane",null),this._name=e,this._price=t,this._img=i,this._CartInstane=s}addToCart(){this._CartInstane.add(this),console.log("Added!",this._name)}render(){const e=document.querySelector(".goods-list");if(e){const n=document.createElement("div");n.innerHTML=`\n        Товар: ${this._name} = ${this._price}\n        <img src="${this._img}" />\n      `,new t("Добавить в корзину",this.addToCart.bind(this)).render(n),e.appendChild(n)}}}class s{constructor({name:e,price:t}){n(this,"_name",""),n(this,"_price",0),n(this,"counter",1),this._name=e,this._price=t}render(e){const t=document.createElement("div");t.innerHTML=`Товар: ${this._name} : ${this._price} x ${this.counter}`,e.appendChild(t)}}const r=new class{constructor(){n(this,"_items",[])}add(e){const t=this._items.find((t=>t._name===e._name));t?t.counter++:this._items.push(new s({name:e._name,price:e._price})),this.render()}render(){const e=document.querySelector(".cart-list");e&&(e.innerHTML=""),this._items.forEach((t=>{t.render(e)}))}};new class{constructor(e){n(this,"_items",[]),this.fetchGoods().then((e=>e.json())).then((t=>{const n=t.data.map((t=>new i(t,e)));this._items=n,this.render()}))}fetchGoods(){return fetch("/database/items.json")}render(){this._items.forEach((e=>{e.render()}))}}(r)})();